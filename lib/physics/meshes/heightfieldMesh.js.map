{"version":3,"sources":["physics/meshes/heightfieldMesh.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;IAEa,e,WAAA,e;;;AACX,2BAAY,QAAZ,EAAsB,QAAtB,EAAgC,IAAhC,EAAsC,IAAtC,EAA4C,IAA5C,EAAkD;AAAA;;AAAA,iHAC1C,QAD0C,EAChC,QADgC,EACtB,IADsB;;AAGhD,UAAK,QAAL,CAAc,IAAd,GAAqB,aAArB;AACA,UAAK,QAAL,CAAc,KAAd,GAAsB,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAzB,GAA6B,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAA5E;AACA,UAAK,QAAL,CAAc,KAAd,GAAsB,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAzB,GAA6B,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAA5E;AACA,UAAK,QAAL,CAAc,IAAd,GAAsB,OAAO,IAAP,KAAgB,WAAjB,GAAgC,KAAK,IAAL,CAAU,SAAS,QAAT,CAAkB,MAA5B,CAAhC,GAAsE,OAAO,CAAlG;AACA,UAAK,QAAL,CAAc,IAAd,GAAsB,OAAO,IAAP,KAAgB,WAAjB,GAAgC,KAAK,IAAL,CAAU,SAAS,QAAT,CAAkB,MAA5B,CAAhC,GAAsE,OAAO,CAAlG;;AAEA,UAAK,QAAL,CAAc,YAAd,GAA6B,KAAK,GAAL,CAAS,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAlC,EAAqC,KAAK,GAAL,CAAS,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAlC,CAArC,CAA7B;;AAEA,QAAM,SAAS,EAAf;;AAEA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,QAAT,CAAkB,MAAtC,EAA8C,GAA9C,EAAmD;AACjD,UAAM,IAAI,IAAI,MAAK,QAAL,CAAc,IAA5B;AACA,UAAM,IAAI,KAAK,KAAL,CAAY,IAAI,MAAK,QAAL,CAAc,IAAnB,GAA6B,IAAI,MAAK,QAAL,CAAc,IAAnB,GAA2B,MAAK,QAAL,CAAc,IAAhF,CAAV;AACA,aAAO,CAAP,IAAY,SAAS,QAAT,CAAkB,IAAM,CAAC,MAAK,QAAL,CAAc,IAAd,GAAqB,CAArB,GAAyB,CAA1B,IAA+B,MAAK,QAAL,CAAc,IAArE,EAA4E,CAAxF;AACD;;AAED,UAAK,QAAL,CAAc,MAAd,GAAuB,MAAvB;AAnBgD;AAoBjD","file":"heightfieldMesh.js","sourcesContent":["import {Mesh} from '../core/mesh';\n\nexport class HeightfieldMesh extends Mesh {\n  constructor(geometry, material, mass, xdiv, ydiv) {\n    super(geometry, material, mass);\n\n    this._physijs.type = 'heightfield';\n    this._physijs.xsize = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\n    this._physijs.ysize = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\n    this._physijs.xpts = (typeof xdiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : xdiv + 1;\n    this._physijs.ypts = (typeof ydiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : ydiv + 1;\n    // note - this assumes our plane geometry is square, unless we pass in specific xdiv and ydiv\n    this._physijs.absMaxHeight = Math.max(geometry.boundingBox.max.z, Math.abs(geometry.boundingBox.min.z));\n\n    const points = [];\n\n    for (let i = 0; i < geometry.vertices.length; i++) {\n      const a = i % this._physijs.xpts;\n      const b = Math.round((i / this._physijs.xpts) - ((i % this._physijs.xpts) / this._physijs.xpts));\n      points[i] = geometry.vertices[a +  ((this._physijs.ypts - b - 1) * this._physijs.ypts)].z;\n    }\n\n    this._physijs.points = points;\n  }\n}\n"]}