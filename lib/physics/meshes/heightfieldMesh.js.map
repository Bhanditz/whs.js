{"version":3,"sources":["physics/meshes/heightfieldMesh.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;IAEa,e,WAAA,e;;;AACX,2BAAY,QAAZ,EAAsB,QAAtB,EAAgC,IAAhC,EAAsC,IAAtC,EAA4C,IAA5C,EAAkD;AAAA;;AAAA,iHAC1C,QAD0C,EAChC,QADgC,EACtB,IADsB;;AAGhD,UAAK,QAAL,CAAc,IAAd,GAAqB,aAArB;AACA,UAAK,QAAL,CAAc,KAAd,GAAsB,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAzB,GAA6B,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAA5E;AACA,UAAK,QAAL,CAAc,KAAd,GAAsB,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAzB,GAA6B,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAA5E;AACA,UAAK,QAAL,CAAc,IAAd,GAAsB,OAAO,IAAP,KAAgB,WAAjB,GAAgC,KAAK,IAAL,CAAU,SAAS,QAAT,CAAkB,MAA5B,CAAhC,GAAsE,OAAO,CAAlG;AACA,UAAK,QAAL,CAAc,IAAd,GAAsB,OAAO,IAAP,KAAgB,WAAjB,GAAgC,KAAK,IAAL,CAAU,SAAS,QAAT,CAAkB,MAA5B,CAAhC,GAAsE,OAAO,CAAlG;AACA;AACA,UAAK,QAAL,CAAc,YAAd,GAA6B,KAAK,GAAL,CAAS,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAlC,EAAqC,KAAK,GAAL,CAAS,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAlC,CAArC,CAA7B;;AAEA,QAAI,OAAO,SAAS,QAAT,CAAkB,MAA7B;;AAEA,QAAM,SAAS,IAAI,YAAJ,CAAiB,IAAjB,CAAf;AAAA,QACE,OAAO,MAAK,QAAL,CAAc,IADvB;AAAA,QAEE,OAAO,MAAK,QAAL,CAAc,IAFvB;;AAIA,WAAO,MAAP,EAAe;AACb,aAAO,IAAP,IAAe,SAAS,QAAT,CACb,OAAO,IAAP,GACG,CAAC,OAAO,KAAK,KAAL,CAAY,OAAO,IAAR,GAAkB,OAAO,IAAR,GAAgB,IAA5C,CAAP,GAA4D,CAA7D,IAAkE,IAFxD,EAGb,CAHF;AAID;;AAED,UAAK,QAAL,CAAc,MAAd,GAAuB,MAAvB;AAxBgD;AAyBjD","file":"heightfieldMesh.js","sourcesContent":["import {Mesh} from '../core/mesh';\r\n\r\nexport class HeightfieldMesh extends Mesh {\r\n  constructor(geometry, material, mass, xdiv, ydiv) {\r\n    super(geometry, material, mass);\r\n\r\n    this._physijs.type = 'heightfield';\r\n    this._physijs.xsize = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\r\n    this._physijs.ysize = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\r\n    this._physijs.xpts = (typeof xdiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : xdiv + 1;\r\n    this._physijs.ypts = (typeof ydiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : ydiv + 1;\r\n    // note - this assumes our plane geometry is square, unless we pass in specific xdiv and ydiv\r\n    this._physijs.absMaxHeight = Math.max(geometry.boundingBox.max.z, Math.abs(geometry.boundingBox.min.z));\r\n\r\n    let size = geometry.vertices.length;\r\n\r\n    const points = new Float32Array(size),\r\n      xpts = this._physijs.xpts,\r\n      ypts = this._physijs.ypts;\r\n\r\n    while (size--) {\r\n      points[size] = geometry.vertices[\r\n        size % xpts\r\n        + ((ypts - Math.round((size / xpts) - ((size % xpts) / xpts)) - 1) * ypts)\r\n      ].z;\r\n    }\r\n\r\n    this._physijs.points = points;\r\n  }\r\n}\r\n"]}