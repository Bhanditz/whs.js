{"version":3,"sources":["physics/meshes/heightfieldMesh.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;IAEa,e,WAAA,e;;;AACX,6BAAY,QAAZ,EAAsB,QAAtB,EAAgC,IAAhC,EAAsC,IAAtC,EAA4C,IAA5C,EAAkD;AAAA;;AAAA,qHAC1C,QAD0C,EAChC,QADgC,EACtB,IADsB;;AAGhD,cAAK,QAAL,CAAc,IAAd,GAAqB,aAArB;AACA,cAAK,QAAL,CAAc,KAAd,GAAsB,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAzB,GAA6B,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAA5E;AACA,cAAK,QAAL,CAAc,KAAd,GAAsB,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAzB,GAA6B,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAA5E;AACA,cAAK,QAAL,CAAc,IAAd,GAAsB,OAAO,IAAP,KAAgB,WAAjB,GAAgC,KAAK,IAAL,CAAU,SAAS,QAAT,CAAkB,MAA5B,CAAhC,GAAsE,OAAO,CAAlG;AACA,cAAK,QAAL,CAAc,IAAd,GAAsB,OAAO,IAAP,KAAgB,WAAjB,GAAgC,KAAK,IAAL,CAAU,SAAS,QAAT,CAAkB,MAA5B,CAAhC,GAAsE,OAAO,CAAlG;;AAEA,cAAK,QAAL,CAAc,YAAd,GAA6B,KAAK,GAAL,CAAS,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAlC,EAAqC,KAAK,GAAL,CAAS,SAAS,WAAT,CAAqB,GAArB,CAAyB,CAAlC,CAArC,CAA7B;;AAEA,YAAM,SAAS,EAAf;;AAEA,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,QAAT,CAAkB,MAAtC,EAA8C,GAA9C,EAAmD;AACjD,gBAAM,IAAI,IAAI,MAAK,QAAL,CAAc,IAA5B;AACA,gBAAM,IAAI,KAAK,KAAL,CAAY,IAAI,MAAK,QAAL,CAAc,IAAnB,GAA6B,IAAI,MAAK,QAAL,CAAc,IAAnB,GAA2B,MAAK,QAAL,CAAc,IAAhF,CAAV;AACA,mBAAO,CAAP,IAAY,SAAS,QAAT,CAAkB,IAAM,CAAC,MAAK,QAAL,CAAc,IAAd,GAAqB,CAArB,GAAyB,CAA1B,IAA+B,MAAK,QAAL,CAAc,IAArE,EAA4E,CAAxF;AACD;;AAED,cAAK,QAAL,CAAc,MAAd,GAAuB,MAAvB;AAnBgD;AAoBjD","file":"heightfieldMesh.js","sourcesContent":["import {Mesh} from '../core/mesh';\r\n\r\nexport class HeightfieldMesh extends Mesh {\r\n  constructor(geometry, material, mass, xdiv, ydiv) {\r\n    super(geometry, material, mass);\r\n\r\n    this._physijs.type = 'heightfield';\r\n    this._physijs.xsize = geometry.boundingBox.max.x - geometry.boundingBox.min.x;\r\n    this._physijs.ysize = geometry.boundingBox.max.y - geometry.boundingBox.min.y;\r\n    this._physijs.xpts = (typeof xdiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : xdiv + 1;\r\n    this._physijs.ypts = (typeof ydiv === 'undefined') ? Math.sqrt(geometry.vertices.length) : ydiv + 1;\r\n    // note - this assumes our plane geometry is square, unless we pass in specific xdiv and ydiv\r\n    this._physijs.absMaxHeight = Math.max(geometry.boundingBox.max.z, Math.abs(geometry.boundingBox.min.z));\r\n\r\n    const points = [];\r\n\r\n    for (let i = 0; i < geometry.vertices.length; i++) {\r\n      const a = i % this._physijs.xpts;\r\n      const b = Math.round((i / this._physijs.xpts) - ((i % this._physijs.xpts) / this._physijs.xpts));\r\n      points[i] = geometry.vertices[a +  ((this._physijs.ypts - b - 1) * this._physijs.ypts)].z;\r\n    }\r\n\r\n    this._physijs.points = points;\r\n  }\r\n}\r\n"]}