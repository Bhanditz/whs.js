{"version":3,"sources":["extras/api.js"],"names":[],"mappings":"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","file":"api.js","sourcesContent":["import * as THREE from 'three';\r\nimport Physijs from '../physics/physi.js';\r\n\r\nimport {JSONLoader, TextureLoader, FontLoader} from '../utils/loaders';\r\n\r\nconst extend = (object, ...extensions) => { // $.extend alternative, ... is the spread operator.\r\n  for (const extension of extensions) {\r\n    // console.log(extension);\r\n    // console.log(typeof extension);\r\n\r\n    if (!extension)\r\n      continue; // Ignore null and undefined objects and paramaters.\r\n\r\n    for (const prop of Object.getOwnPropertyNames(extension)) { // Do not traverse the prototype chain.\r\n      if (object[prop] !== undefined\r\n        && object[prop].toString() === '[object Object]'\r\n        && extension[prop].toString() === '[object Object]')\r\n\r\n        // Goes deep only if object[prop] and extension[prop] are both objects !\r\n        extend(object[prop], extension[prop]);\r\n\r\n      else\r\n        object[prop] = (object[prop] === 0) ? 0 : object[prop];\r\n      if (typeof object[prop] === 'undefined') object[prop] = extension[prop]; // Add values that do not already exist.\r\n    }\r\n  }\r\n\r\n  return object;\r\n};\r\n\r\nconst texture = (url, repeat = {}) => {\r\n  const texture = TextureLoader.load(url);\r\n\r\n  if (repeat) {\r\n    const opt = extend(repeat, {\r\n      offset: {\r\n        x: 0,\r\n        y: 0\r\n      },\r\n      repeat: {\r\n        x: 1,\r\n        y: 1\r\n      }\r\n    });\r\n\r\n    texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\r\n\r\n    texture.offset.set(opt.offset.x, opt.offset.y);\r\n    texture.repeat.set(opt.repeat.x, opt.repeat.y);\r\n\r\n    texture.magFilter = THREE.NearestFilter;\r\n    texture.minFilter = THREE.LinearMipMapLinearFilter;\r\n  }\r\n\r\n  return texture;\r\n};\r\n\r\nconst loadMaterial = (material = {}, isPhysics = true) => {\r\n  if (typeof material.kind !== 'string')\r\n    console.error('Type of material is undefined or not a string. @loadMaterial');\r\n\r\n  const scope = {\r\n    _type: material.kind,\r\n    _restitution: !isNaN(parseFloat(material.restitution)) ?\r\n      material.restitution : !isNaN(parseFloat(material.rest)) ?\r\n      material.rest : 0.3,\r\n    _friction: !isNaN(parseFloat(material.friction)) ?\r\n      material.friction : !isNaN(parseFloat(material.fri)) ?\r\n      material.fri : 0.8\r\n  };\r\n\r\n  if (material.texture) material.map = texture(material.texture);\r\n\r\n  const params = Object.assign({}, material);\r\n\r\n  delete params.kind;\r\n\r\n  delete params.friction;\r\n  delete params.fri;\r\n\r\n  delete params.restitution;\r\n  delete params.rest;\r\n\r\n  delete params.useCustomMaterial;\r\n  delete params.useVertexColors;\r\n\r\n  switch (material.kind) {\r\n    case 'basic':\r\n      scope._material = new THREE.MeshBasicMaterial(params);\r\n      break;\r\n\r\n    case 'linebasic':\r\n      scope._material = new THREE.LineBasicMaterial(params);\r\n      break;\r\n\r\n    case 'linedashed':\r\n      scope._material = new THREE.LineDashedMaterial(params);\r\n      break;\r\n\r\n    case 'material':\r\n      scope._material = new THREE.Material(params);\r\n      break;\r\n\r\n    case 'depth':\r\n      scope._material = new THREE.MeshDepthMaterial(params);\r\n      break;\r\n\r\n    case 'face':\r\n      scope._material = new THREE.MeshFaceMaterial(params);\r\n      break;\r\n\r\n    case 'lambert':\r\n      scope._material = new THREE.MeshLambertMaterial(params);\r\n      break;\r\n\r\n    case 'normal':\r\n      scope._material = new THREE.MeshNormalMaterial(params);\r\n      break;\r\n\r\n    case 'phong':\r\n      scope._material = new THREE.MeshPhongMaterial(params);\r\n      break;\r\n\r\n    case 'pointcloud':\r\n      scope._material = new THREE.PointCloudMaterial(params);\r\n      break;\r\n\r\n    case 'rawshader':\r\n      scope._material = new THREE.RawShaderMaterial(params);\r\n      break;\r\n\r\n    case 'shader':\r\n      scope._material = new THREE.ShaderMaterial(params);\r\n      break;\r\n\r\n    case 'spritecanvas':\r\n      scope._material = new THREE.SpriteCanvasMaterial(params);\r\n      break;\r\n\r\n    case 'sprite':\r\n      scope._material = new THREE.SpriteMaterial(params);\r\n      break;\r\n\r\n    default:\r\n  }\r\n\r\n  if (isPhysics) {\r\n    scope._materialP = Physijs.createMaterial(\r\n      scope._material,\r\n      scope._friction,\r\n      scope._restitution\r\n    );\r\n  }\r\n\r\n  return scope;\r\n};\r\n\r\nexport {\r\n  FontLoader,\r\n  JSONLoader,\r\n  TextureLoader,\r\n  texture,\r\n  extend,\r\n  loadMaterial\r\n};\r\n"]}