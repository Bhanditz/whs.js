{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap f08149ccd5a8050b719f","webpack:///external \"WHS\"","webpack:///./src/index.js","webpack:///./src/lib/VREffect.js","webpack:///./src/lib/WebVR.js"],"names":["VRModule","scene","camera","manager","rendering","use","renderer","get","resize","effect","addCallback","width","height","setSize","apply","checkAvailability","catch","document","body","appendChild","getMessageContainer","message","getVRDisplay","getButton","display","domElement","VREffect","onError","vrDisplay","vrDisplays","eyeTranslationL","THREE","Vector3","eyeTranslationR","renderRectL","renderRectR","frameData","window","VRFrameData","gotVRDisplays","displays","length","navigator","getVRDisplays","then","console","warn","isPresenting","scale","scope","rendererSize","getSize","rendererUpdateStyle","rendererPixelRatio","getPixelRatio","setVRDisplay","value","updateStyle","eyeParamsL","getEyeParameters","setPixelRatio","renderWidth","renderHeight","canvas","requestFullscreen","exitFullscreen","fullscreenElement","defaultLeftBounds","defaultRightBounds","onVRDisplayPresentChange","wasPresenting","undefined","eyeWidth","eyeHeight","addEventListener","setFullScreen","boolean","Promise","resolve","reject","Error","requestPresent","source","exitPresent","requestAnimationFrame","f","cancelAnimationFrame","h","submitFrame","autoSubmitFrame","cameraL","PerspectiveCamera","layers","enable","cameraR","render","renderTarget","forceClear","autoUpdate","updateMatrixWorld","eyeParamsR","fromArray","offset","Array","isArray","size","getLayers","leftBounds","rightBounds","layer","x","Math","round","y","setRenderTarget","scissorTest","setScissorTest","autoClear","clear","parent","matrixWorld","decompose","position","quaternion","translateOnAxis","getFrameData","depthNear","near","depthFar","far","projectionMatrix","elements","leftProjectionMatrix","rightProjectionMatrix","fovToProjection","fieldOfView","viewport","set","scissor","setViewport","setScissor","dispose","removeEventListener","fovToNDCScaleOffset","fov","pxscale","leftTan","rightTan","pxoffset","pyscale","upTan","downTan","pyoffset","fovPortToProjection","rightHanded","zNear","zFar","handednessScale","mobj","Matrix4","m","scaleAndOffset","transpose","DEG2RAD","PI","fovPort","tan","upDegrees","downDegrees","leftDegrees","rightDegrees","WEBVR","isAvailable","onDisplay","getMessage","container","createElement","style","left","top","right","zIndex","align","error","fontFamily","fontSize","fontStyle","lineHeight","backgroundColor","color","padding","margin","innerHTML","button","bottom","border","cursor","textAlign","textContent","onclick"],"mappings":"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","file":"VRKit.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"WHS\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"WHS\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VRKit\"] = factory(require(\"WHS\"));\n\telse\n\t\troot[\"VRKit\"] = factory(root[\"WHS\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f08149ccd5a8050b719f","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"WHS\"\n// module id = 0\n// module chunks = 0","import {Loop} from 'whs';\n\nimport {VREffect} from './lib/VREffect';\nimport {WEBVR} from './lib/WebVR';\n\nexport class VRModule {\n  constructor() {\n    this.scene = null;\n    this.camera = null;\n  }\n\n  manager(manager) {\n    const rendering = manager.use('rendering');\n    const renderer = manager.get('renderer');\n\n    const resize = manager.use('resize');\n\n    const effect = new VREffect(renderer);\n\n    this.scene = manager.get('scene');\n    this.camera = manager.get('camera');\n\n    rendering.effect(effect);\n\n    // TODO: Fix resize.\n\n    resize.addCallback((width, height) => {\n      effect.setSize.apply(effect, [width, height]);\n    });\n\n    // WEBVR\n\n    WEBVR.checkAvailability().catch(message => {\n\t\t\tdocument.body.appendChild(WEBVR.getMessageContainer(message));\n\t\t});\n\n    WEBVR.getVRDisplay(display => {\n      document.body.appendChild(WEBVR.getButton(display, renderer.domElement));\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * @author dmarcos / https://github.com/dmarcos\n * @author mrdoob / http://mrdoob.com\n *\n * WebVR Spec: http://mozvr.github.io/webvr-spec/webvr.html\n *\n * Firefox: http://mozvr.com/downloads/\n * Chromium: https://webvr.info/get-chrome\n *\n */\n\nexport const VREffect = function ( renderer, onError ) {\n\n\tvar vrDisplay, vrDisplays;\n\tvar eyeTranslationL = new THREE.Vector3();\n\tvar eyeTranslationR = new THREE.Vector3();\n\tvar renderRectL, renderRectR;\n\n\tvar frameData = null;\n\n\tif ( 'VRFrameData' in window ) {\n\n\t\tframeData = new VRFrameData();\n\n\t}\n\n\tfunction gotVRDisplays( displays ) {\n\n\t\tvrDisplays = displays;\n\n\t\tif ( displays.length > 0 ) {\n\n\t\t\tvrDisplay = displays[ 0 ];\n\n\t\t} else {\n\n\t\t\tif ( onError ) onError( 'HMD not available' );\n\n\t\t}\n\n\t}\n\n\tif ( navigator.getVRDisplays ) {\n\n\t\tnavigator.getVRDisplays().then( gotVRDisplays ).catch ( function () {\n\n\t\t\tconsole.warn( 'THREE.VREffect: Unable to get VR Displays' );\n\n\t\t} );\n\n\t}\n\n\t//\n\n\tthis.isPresenting = false;\n\tthis.scale = 1;\n\n\tvar scope = this;\n\n\tvar rendererSize = renderer.getSize();\n\tvar rendererUpdateStyle = false;\n\tvar rendererPixelRatio = renderer.getPixelRatio();\n\n\tthis.getVRDisplay = function () {\n\n\t\treturn vrDisplay;\n\n\t};\n\n\tthis.setVRDisplay = function ( value ) {\n\n\t\tvrDisplay = value;\n\n\t};\n\n\tthis.getVRDisplays = function () {\n\n\t\tconsole.warn( 'THREE.VREffect: getVRDisplays() is being deprecated.' );\n\t\treturn vrDisplays;\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\trendererSize = { width: width, height: height };\n\t\trendererUpdateStyle = updateStyle;\n\n\t\tif ( scope.isPresenting ) {\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\trenderer.setPixelRatio( 1 );\n\t\t\trenderer.setSize( eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false );\n\n\t\t} else {\n\n\t\t\trenderer.setPixelRatio( rendererPixelRatio );\n\t\t\trenderer.setSize( width, height, updateStyle );\n\n\t\t}\n\n\t};\n\n\t// fullscreen\n\n\tvar canvas = renderer.domElement;\n\tvar requestFullscreen;\n\tvar exitFullscreen;\n\tvar fullscreenElement;\n\tvar defaultLeftBounds = [ 0.0, 0.0, 0.5, 1.0 ];\n\tvar defaultRightBounds = [ 0.5, 0.0, 0.5, 1.0 ];\n\n\tfunction onVRDisplayPresentChange() {\n\n\t\tvar wasPresenting = scope.isPresenting;\n\t\tscope.isPresenting = vrDisplay !== undefined && vrDisplay.isPresenting;\n\n\t\tif ( scope.isPresenting ) {\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\tvar eyeWidth = eyeParamsL.renderWidth;\n\t\t\tvar eyeHeight = eyeParamsL.renderHeight;\n\n\t\t\tif ( !wasPresenting ) {\n\n\t\t\t\trendererPixelRatio = renderer.getPixelRatio();\n\t\t\t\trendererSize = renderer.getSize();\n\n\t\t\t\trenderer.setPixelRatio( 1 );\n\t\t\t\trenderer.setSize( eyeWidth * 2, eyeHeight, false );\n\n\t\t\t}\n\n\t\t} else if ( wasPresenting ) {\n\n\t\t\trenderer.setPixelRatio( rendererPixelRatio );\n\t\t\trenderer.setSize( rendererSize.width, rendererSize.height, rendererUpdateStyle );\n\n\t\t}\n\n\t}\n\n\twindow.addEventListener( 'vrdisplaypresentchange', onVRDisplayPresentChange, false );\n\n\tthis.setFullScreen = function ( boolean ) {\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tif ( vrDisplay === undefined ) {\n\n\t\t\t\treject( new Error( 'No VR hardware found.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( scope.isPresenting === boolean ) {\n\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( boolean ) {\n\n\t\t\t\tresolve( vrDisplay.requestPresent( [ { source: canvas } ] ) );\n\n\t\t\t} else {\n\n\t\t\t\tresolve( vrDisplay.exitPresent() );\n\n\t\t\t}\n\n\t\t} );\n\n\t};\n\n\tthis.requestPresent = function () {\n\n\t\treturn this.setFullScreen( true );\n\n\t};\n\n\tthis.exitPresent = function () {\n\n\t\treturn this.setFullScreen( false );\n\n\t};\n\n\tthis.requestAnimationFrame = function ( f ) {\n\n\t\tif ( vrDisplay !== undefined ) {\n\n\t\t\treturn vrDisplay.requestAnimationFrame( f );\n\n\t\t} else {\n\n\t\t\treturn window.requestAnimationFrame( f );\n\n\t\t}\n\n\t};\n\n\tthis.cancelAnimationFrame = function ( h ) {\n\n\t\tif ( vrDisplay !== undefined ) {\n\n\t\t\tvrDisplay.cancelAnimationFrame( h );\n\n\t\t} else {\n\n\t\t\twindow.cancelAnimationFrame( h );\n\n\t\t}\n\n\t};\n\n\tthis.submitFrame = function () {\n\n\t\tif ( vrDisplay !== undefined && scope.isPresenting ) {\n\n\t\t\tvrDisplay.submitFrame();\n\n\t\t}\n\n\t};\n\n\tthis.autoSubmitFrame = true;\n\n\t// render\n\n\tvar cameraL = new THREE.PerspectiveCamera();\n\tcameraL.layers.enable( 1 );\n\n\tvar cameraR = new THREE.PerspectiveCamera();\n\tcameraR.layers.enable( 2 );\n\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\n\n\t\tif ( vrDisplay && scope.isPresenting ) {\n\n\t\t\tvar autoUpdate = scene.autoUpdate;\n\n\t\t\tif ( autoUpdate ) {\n\n\t\t\t\tscene.updateMatrixWorld();\n\t\t\t\tscene.autoUpdate = false;\n\n\t\t\t}\n\n\t\t\tvar eyeParamsL = vrDisplay.getEyeParameters( 'left' );\n\t\t\tvar eyeParamsR = vrDisplay.getEyeParameters( 'right' );\n\n\t\t\teyeTranslationL.fromArray( eyeParamsL.offset );\n\t\t\teyeTranslationR.fromArray( eyeParamsR.offset );\n\n\t\t\tif ( Array.isArray( scene ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.VREffect.render() no longer supports arrays. Use object.layers instead.' );\n\t\t\t\tscene = scene[ 0 ];\n\n\t\t\t}\n\n\t\t\t// When rendering we don't care what the recommended size is, only what the actual size\n\t\t\t// of the backbuffer is.\n\t\t\tvar size = renderer.getSize();\n\t\t\tvar layers = vrDisplay.getLayers();\n\t\t\tvar leftBounds;\n\t\t\tvar rightBounds;\n\n\t\t\tif ( layers.length ) {\n\n\t\t\t\tvar layer = layers[ 0 ];\n\n\t\t\t\tleftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : defaultLeftBounds;\n\t\t\t\trightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : defaultRightBounds;\n\n\t\t\t} else {\n\n\t\t\t\tleftBounds = defaultLeftBounds;\n\t\t\t\trightBounds = defaultRightBounds;\n\n\t\t\t}\n\n\t\t\trenderRectL = {\n\t\t\t\tx: Math.round( size.width * leftBounds[ 0 ] ),\n\t\t\t\ty: Math.round( size.height * leftBounds[ 1 ] ),\n\t\t\t\twidth: Math.round( size.width * leftBounds[ 2 ] ),\n\t\t\t\theight: Math.round(size.height * leftBounds[ 3 ] )\n\t\t\t};\n\t\t\trenderRectR = {\n\t\t\t\tx: Math.round( size.width * rightBounds[ 0 ] ),\n\t\t\t\ty: Math.round( size.height * rightBounds[ 1 ] ),\n\t\t\t\twidth: Math.round( size.width * rightBounds[ 2 ] ),\n\t\t\t\theight: Math.round(size.height * rightBounds[ 3 ] )\n\t\t\t};\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderer.setRenderTarget( renderTarget );\n\t\t\t\trenderTarget.scissorTest = true;\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setRenderTarget( null );\n\t\t\t\trenderer.setScissorTest( true );\n\n\t\t\t}\n\n\t\t\tif ( renderer.autoClear || forceClear ) renderer.clear();\n\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t\tcamera.matrixWorld.decompose( cameraL.position, cameraL.quaternion, cameraL.scale );\n\t\t\tcamera.matrixWorld.decompose( cameraR.position, cameraR.quaternion, cameraR.scale );\n\n\t\t\tvar scale = this.scale;\n\t\t\tcameraL.translateOnAxis( eyeTranslationL, scale );\n\t\t\tcameraR.translateOnAxis( eyeTranslationR, scale );\n\n\t\t\tif ( vrDisplay.getFrameData ) {\n\n\t\t\t\tvrDisplay.depthNear = camera.near;\n\t\t\t\tvrDisplay.depthFar = camera.far;\n\n\t\t\t\tvrDisplay.getFrameData( frameData );\n\n\t\t\t\tcameraL.projectionMatrix.elements = frameData.leftProjectionMatrix;\n\t\t\t\tcameraR.projectionMatrix.elements = frameData.rightProjectionMatrix;\n\n\t\t\t} else {\n\n\t\t\t\tcameraL.projectionMatrix = fovToProjection( eyeParamsL.fieldOfView, true, camera.near, camera.far );\n\t\t\t\tcameraR.projectionMatrix = fovToProjection( eyeParamsR.fieldOfView, true, camera.near, camera.far );\n\n\t\t\t}\n\n\t\t\t// render left eye\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\t\t\t\trenderTarget.scissor.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\t\t\t\trenderer.setScissor( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );\n\n\t\t\t}\n\t\t\trenderer.render( scene, cameraL, renderTarget, forceClear );\n\n\t\t\t// render right eye\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\t\t\t\trenderTarget.scissor.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\t\t\t\trenderer.setScissor( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );\n\n\t\t\t}\n\t\t\trenderer.render( scene, cameraR, renderTarget, forceClear );\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\trenderTarget.viewport.set( 0, 0, size.width, size.height );\n\t\t\t\trenderTarget.scissor.set( 0, 0, size.width, size.height );\n\t\t\t\trenderTarget.scissorTest = false;\n\t\t\t\trenderer.setRenderTarget( null );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setViewport( 0, 0, size.width, size.height );\n\t\t\t\trenderer.setScissorTest( false );\n\n\t\t\t}\n\n\t\t\tif ( autoUpdate ) {\n\n\t\t\t\tscene.autoUpdate = true;\n\n\t\t\t}\n\n\t\t\tif ( scope.autoSubmitFrame ) {\n\n\t\t\t\tscope.submitFrame();\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Regular render mode if not HMD\n\n\t\trenderer.render( scene, camera, renderTarget, forceClear );\n\n\t};\n\n\tthis.dispose = function () {\n\n\t\twindow.removeEventListener( 'vrdisplaypresentchange', onVRDisplayPresentChange, false );\n\n\t};\n\n\t//\n\n\tfunction fovToNDCScaleOffset( fov ) {\n\n\t\tvar pxscale = 2.0 / ( fov.leftTan + fov.rightTan );\n\t\tvar pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;\n\t\tvar pyscale = 2.0 / ( fov.upTan + fov.downTan );\n\t\tvar pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;\n\t\treturn { scale: [ pxscale, pyscale ], offset: [ pxoffset, pyoffset ] };\n\n\t}\n\n\tfunction fovPortToProjection( fov, rightHanded, zNear, zFar ) {\n\n\t\trightHanded = rightHanded === undefined ? true : rightHanded;\n\t\tzNear = zNear === undefined ? 0.01 : zNear;\n\t\tzFar = zFar === undefined ? 10000.0 : zFar;\n\n\t\tvar handednessScale = rightHanded ? - 1.0 : 1.0;\n\n\t\t// start with an identity matrix\n\t\tvar mobj = new THREE.Matrix4();\n\t\tvar m = mobj.elements;\n\n\t\t// and with scale/offset info for normalized device coords\n\t\tvar scaleAndOffset = fovToNDCScaleOffset( fov );\n\n\t\t// X result, map clip edges to [-w,+w]\n\t\tm[ 0 * 4 + 0 ] = scaleAndOffset.scale[ 0 ];\n\t\tm[ 0 * 4 + 1 ] = 0.0;\n\t\tm[ 0 * 4 + 2 ] = scaleAndOffset.offset[ 0 ] * handednessScale;\n\t\tm[ 0 * 4 + 3 ] = 0.0;\n\n\t\t// Y result, map clip edges to [-w,+w]\n\t\t// Y offset is negated because this proj matrix transforms from world coords with Y=up,\n\t\t// but the NDC scaling has Y=down (thanks D3D?)\n\t\tm[ 1 * 4 + 0 ] = 0.0;\n\t\tm[ 1 * 4 + 1 ] = scaleAndOffset.scale[ 1 ];\n\t\tm[ 1 * 4 + 2 ] = - scaleAndOffset.offset[ 1 ] * handednessScale;\n\t\tm[ 1 * 4 + 3 ] = 0.0;\n\n\t\t// Z result (up to the app)\n\t\tm[ 2 * 4 + 0 ] = 0.0;\n\t\tm[ 2 * 4 + 1 ] = 0.0;\n\t\tm[ 2 * 4 + 2 ] = zFar / ( zNear - zFar ) * - handednessScale;\n\t\tm[ 2 * 4 + 3 ] = ( zFar * zNear ) / ( zNear - zFar );\n\n\t\t// W result (= Z in)\n\t\tm[ 3 * 4 + 0 ] = 0.0;\n\t\tm[ 3 * 4 + 1 ] = 0.0;\n\t\tm[ 3 * 4 + 2 ] = handednessScale;\n\t\tm[ 3 * 4 + 3 ] = 0.0;\n\n\t\tmobj.transpose();\n\n\t\treturn mobj;\n\n\t}\n\n\tfunction fovToProjection( fov, rightHanded, zNear, zFar ) {\n\n\t\tvar DEG2RAD = Math.PI / 180.0;\n\n\t\tvar fovPort = {\n\t\t\tupTan: Math.tan( fov.upDegrees * DEG2RAD ),\n\t\t\tdownTan: Math.tan( fov.downDegrees * DEG2RAD ),\n\t\t\tleftTan: Math.tan( fov.leftDegrees * DEG2RAD ),\n\t\t\trightTan: Math.tan( fov.rightDegrees * DEG2RAD )\n\t\t};\n\n\t\treturn fovPortToProjection( fovPort, rightHanded, zNear, zFar );\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/VREffect.js","/**\n * @author mrdoob / http://mrdoob.com\n * @author Mugen87 / https://github.com/Mugen87\n *\n * Based on @tojiro's vr-samples-utils.js\n */\n\nexport const WEBVR = {\n\n\tisAvailable: function () {\n\n\t\tconsole.warn( 'WEBVR: isAvailable() is being deprecated. Use .checkAvailability() instead.' );\n\t\treturn navigator.getVRDisplays !== undefined;\n\n\t},\n\n\tcheckAvailability: function () {\n\n\t\treturn new Promise( function( resolve, reject ) {\n\n\t\t\tif ( navigator.getVRDisplays !== undefined ) {\n\n\t\t\t\tnavigator.getVRDisplays().then( function ( displays ) {\n\n\t\t\t\t\tif ( displays.length === 0 ) {\n\n\t\t\t\t\t\treject( 'WebVR supported, but no VRDisplays found.' );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tresolve();\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t} else {\n\n\t\t\t\treject( 'Your browser does not support WebVR. See <a href=\"https://webvr.info\">webvr.info</a> for assistance.' );\n\n\t\t\t}\n\n\t\t} );\n\n\t},\n\n\tgetVRDisplay: function ( onDisplay ) {\n\n\t\tif ( 'getVRDisplays' in navigator ) {\n\n\t\t\tnavigator.getVRDisplays()\n\t\t\t\t.then( function ( displays ) {\n\t\t\t\t\tonDisplay( displays[ 0 ] );\n\t\t\t\t} );\n\n\t\t}\n\n\t},\n\n\tgetMessage: function () {\n\n\t\tconsole.warn( 'WEBVR: getMessage() is being deprecated. Use .getMessageContainer( message ) instead.' );\n\n\t\tvar message;\n\n\t\tif ( navigator.getVRDisplays ) {\n\n\t\t\tnavigator.getVRDisplays().then( function ( displays ) {\n\n\t\t\t\tif ( displays.length === 0 ) message = 'WebVR supported, but no VRDisplays found.';\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\tmessage = 'Your browser does not support WebVR. See <a href=\"http://webvr.info\">webvr.info</a> for assistance.';\n\n\t\t}\n\n\t\tif ( message !== undefined ) {\n\n\t\t\tvar container = document.createElement( 'div' );\n\t\t\tcontainer.style.position = 'absolute';\n\t\t\tcontainer.style.left = '0';\n\t\t\tcontainer.style.top = '0';\n\t\t\tcontainer.style.right = '0';\n\t\t\tcontainer.style.zIndex = '999';\n\t\t\tcontainer.align = 'center';\n\n\t\t\tvar error = document.createElement( 'div' );\n\t\t\terror.style.fontFamily = 'sans-serif';\n\t\t\terror.style.fontSize = '16px';\n\t\t\terror.style.fontStyle = 'normal';\n\t\t\terror.style.lineHeight = '26px';\n\t\t\terror.style.backgroundColor = '#fff';\n\t\t\terror.style.color = '#000';\n\t\t\terror.style.padding = '10px 20px';\n\t\t\terror.style.margin = '50px';\n\t\t\terror.style.display = 'inline-block';\n\t\t\terror.innerHTML = message;\n\t\t\tcontainer.appendChild( error );\n\n\t\t\treturn container;\n\n\t\t}\n\n\t},\n\n\tgetMessageContainer: function ( message ) {\n\n\t\tvar container = document.createElement( 'div' );\n\t\tcontainer.style.position = 'absolute';\n\t\tcontainer.style.left = '0';\n\t\tcontainer.style.top = '0';\n\t\tcontainer.style.right = '0';\n\t\tcontainer.style.zIndex = '999';\n\t\tcontainer.align = 'center';\n\n\t\tvar error = document.createElement( 'div' );\n\t\terror.style.fontFamily = 'sans-serif';\n\t\terror.style.fontSize = '16px';\n\t\terror.style.fontStyle = 'normal';\n\t\terror.style.lineHeight = '26px';\n\t\terror.style.backgroundColor = '#fff';\n\t\terror.style.color = '#000';\n\t\terror.style.padding = '10px 20px';\n\t\terror.style.margin = '50px';\n\t\terror.style.display = 'inline-block';\n\t\terror.innerHTML = message;\n\t\tcontainer.appendChild( error );\n\n\t\treturn container;\n\n\t},\n\n\tgetButton: function ( display, canvas ) {\n\n\t\tif ( 'VREffect' in THREE && display instanceof THREE.VREffect ) {\n\n\t\t\tconsole.error( 'WebVR.getButton() now expects a VRDisplay.' );\n\t\t\treturn document.createElement( 'button' );\n\n\t\t}\n\n\t\tvar button = document.createElement( 'button' );\n\t\tbutton.style.position = 'absolute';\n\t\tbutton.style.left = 'calc(50% - 50px)';\n\t\tbutton.style.bottom = '20px';\n\t\tbutton.style.width = '100px';\n\t\tbutton.style.border = '0';\n\t\tbutton.style.padding = '8px';\n\t\tbutton.style.cursor = 'pointer';\n\t\tbutton.style.backgroundColor = '#000';\n\t\tbutton.style.color = '#fff';\n\t\tbutton.style.fontFamily = 'sans-serif';\n\t\tbutton.style.fontSize = '13px';\n\t\tbutton.style.fontStyle = 'normal';\n\t\tbutton.style.textAlign = 'center';\n\t\tbutton.style.zIndex = '999';\n\n\t\tif ( display ) {\n\n\t\t\tbutton.textContent = 'ENTER VR';\n\t\t\tbutton.onclick = function () {\n\n\t\t\t\tdisplay.isPresenting ? display.exitPresent() : display.requestPresent( [ { source: canvas } ] );\n\n\t\t\t};\n\n\t\t\twindow.addEventListener( 'vrdisplaypresentchange', function () {\n\n\t\t\t\tbutton.textContent = display.isPresenting ? 'EXIT VR' : 'ENTER VR';\n\n\t\t\t}, false );\n\n\t\t} else {\n\n\t\t\tbutton.textContent = 'NO VR DISPLAY';\n\n\t\t}\n\n\t\treturn button;\n\n\t}\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/WebVR.js"],"sourceRoot":""}